"use strict";(self.webpackChunkendless_starterkit=self.webpackChunkendless_starterkit||[]).push([[287],{87287:(x,Z,r)=>{r.r(Z),r.d(Z,{SubjectsModule:()=>Fe});var g=r(69808),T=r(74202),v=r(70655),e=r(5e3),f=r(21242),p=r(34578),_=r(64383),q=r(4426),l=r(93075),S=r(61676),u=r(98952),b=r(59783),A=r(40845),j=r(25787);function M(o,s){1&o&&e._UZ(0,"i",28)}function y(o,s){1&o&&(e.TgZ(0,"div",29),e._UZ(1,"span",30),e.qZA())}function N(o,s){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th",35),e._uU(2,"SlNo "),e._UZ(3,"p-sortIcon",36),e.qZA(),e.TgZ(4,"th",37),e._uU(5,"Name "),e._UZ(6,"p-sortIcon",38),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Actions"),e.qZA(),e.qZA())}function U(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.TgZ(6,"div"),e.TgZ(7,"button",39),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).update(a)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=s.$implicit,i=s.rowIndex;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.name)}}const F=function(){return[10,25,50]};function L(o,s){if(1&o&&(e.TgZ(0,"p-table",31,32),e.YNc(2,N,9,0,"ng-template",33),e.YNc(3,U,8,2,"ng-template",34),e.qZA()),2&o){const t=e.oxw();e.Q6J("value",t.List)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(5,F))}}let I=(()=>{class o{constructor(t,i,n,a){this.apiService=t,this.spinner=i,this.toster=n,this.confirmationService=a,this.loader=!1,this.issubjectsFilter=!0,this.dataFetch=!1,this.editIndex=-1,this.List=[],this.subjects=[],this.filterValue="",this.addValue=""}ngOnInit(){this.loader=!1,this.dataFetch=!0,this.apiService.getTypeRequest("table_data/SUBJECT").subscribe(t=>{this.List=t.data,this.subjects=t.data,this.dataFetch=!1})}editClick(t,i){this.editValue=i.name,this.editIndex=t}onClear(){this.List=this.subjects}update(t){this.addValue=t.name,this.id=t.id,this.institution_id=t.institution_id}onFilter(t){this.editValue=t,this.List=[],this.subjects.filter(i=>{i.name.toLowerCase().includes(t.toLowerCase())&&this.List.push(i)})}isValueAvailable(){return!(null!=this.subjects&&this.subjects.length>0&&this.subjects.filter(i=>{if(i.name.toLowerCase()==this.addValue.toLowerCase())return i}).length>0)}onAddNew(){if(this.loader=!0,this.addValue.length>0&&null!=this.id){var t={item_id:this.id,item_name:this.addValue};this.confirmationService.showUpdateConfirmDialog().then(n=>{n.value?this.apiService.postTypeRequest("subject_ops/update",t).toPromise().then(a=>{a.result?(this.toster.warning("Data Updated"),this.confirmationService.showWarningMessage("Data Updated",a.message),this.ngOnInit(),this.Clear()):(this.confirmationService.showErrorMessage("Cancelled!",a.message),this.loader=!1)}):this.loader=!1})}else this.addValue.length>0&&this.isValueAvailable()?(this.apiService.postTypeRequest("subject_ops/insert",{item_name:this.addValue}).subscribe(n=>{n.result?(this.subjects=n.data,this.List=n.data,this.ngOnInit(),this.Clear(),this.toster.success("New Data Added"),this.confirmationService.showSuccessMessage("Added",n.message)):this.loader=!1}),this.addValue=""):this.addValue.length>0?(this.toster.error("Value alredy Exists"),this.loader=!1):(this.toster.error("Cannot add empty value"),this.loader=!1)}Clear(){this.addValue="",this.id=null,this.institution_id=null}onDelete(t){return(0,v.mG)(this,void 0,void 0,function*(){var i={item_id:t};this.confirmationService.showDeleteConfirmDialog().then(n=>{n.value&&this.apiService.postTypeRequest("subject_ops/delete",i).toPromise().then(a=>{a.result?(this.toster.warning("Data deleted"),this.confirmationService.showWarningMessage("Deleted",a.message),this.ngOnInit()):this.confirmationService.showErrorMessage("Cancelled!",a.message)})})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.s),e.Y36(p.V),e.Y36(_._W),e.Y36(q.Y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-subject"]],decls:42,vars:8,consts:[[1,"container-fluid"],[1,"row"],[1,"col-xl-3","xl-40"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row",2,"gap","10px"],[1,"col-12"],[1,"job-filter"],[1,"faq-form"],["for","bg_id"],[1,"font-danger"],["type","text","placeholder","English..",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","d-flex","justify-content-around"],["type","submit",1,"btn","btn-primary",2,"max-height","36px",3,"disabled","click"],["class","fa fa-circle-o-notch fa-spin",4,"ngIf"],["type","button",1,"btn","btn-warning",2,"max-height","36px",3,"click"],[1,"col-xl-9","xl-60"],[1,"collapse","show"],[1,"row","mt-4","pl-3","pr-3"],[1,"col-md-8","col-sm-8"],["type","text","placeholder","Search..",1,"form-control",3,"ngModel","ngModelChange","keyup"],[1,"search-icon",3,"icon"],[1,"col-md-3","col-sm-3","d-flex","justify-content-around"],["type","button",1,"btn","btn-warning","text-center",3,"click"],[1,"card-body","custom-datatable"],["class","loader-box center",4,"ngIf"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions",4,"ngIf"],[1,"fa","fa-circle-o-notch","fa-spin"],[1,"loader-box","center"],[1,"rotate","dashed"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["table",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","code"],["field","code"],["pSortableColumn","name"],["field","name"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded",2,"height","35px","width","35px",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"h5"),e._uU(6,"New Subject"),e.qZA(),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.TgZ(9,"div",7),e.TgZ(10,"div",8),e.TgZ(11,"div",9),e.TgZ(12,"label",10),e._uU(13,"Name "),e.TgZ(14,"span",11),e._uU(15,"*"),e.qZA(),e.qZA(),e.TgZ(16,"input",12),e.NdJ("ngModelChange",function(a){return i.addValue=a}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",13),e.TgZ(18,"button",14),e.NdJ("click",function(){return i.onAddNew()}),e._uU(19),e.YNc(20,M,1,0,"i",15),e.qZA(),e.TgZ(21,"button",16),e.NdJ("click",function(){return i.Clear()}),e._uU(22," Clear "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",17),e.TgZ(24,"div",3),e.TgZ(25,"div",4),e.TgZ(26,"h5"),e._uU(27,"Subjects"),e.qZA(),e.qZA(),e.TgZ(28,"div",18),e.TgZ(29,"div",5),e.TgZ(30,"div",19),e.TgZ(31,"div",20),e.TgZ(32,"div",9),e.TgZ(33,"input",21),e.NdJ("ngModelChange",function(a){return i.filterValue=a})("keyup",function(a){return i.onFilter(a.target.value)}),e.qZA(),e._UZ(34,"app-feather-icons",22),e.qZA(),e.qZA(),e.TgZ(35,"div",23),e.TgZ(36,"button",24),e.NdJ("click",function(){return i.filterValue="",i.onClear()}),e._uU(37," Clear "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"div",1),e.TgZ(39,"div",25),e.YNc(40,y,2,0,"div",26),e.YNc(41,L,4,6,"p-table",27),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(16),e.Q6J("ngModel",i.addValue),e.xp6(2),e.Q6J("disabled",i.loader),e.xp6(1),e.hij(" ",i.loader?"":null!=i.id?"Update":"Add","\xa0"),e.xp6(1),e.Q6J("ngIf",i.loader),e.xp6(13),e.Q6J("ngModel",i.filterValue),e.xp6(1),e.Q6J("icon","search"),e.xp6(6),e.Q6J("ngIf",i.dataFetch),e.xp6(1),e.Q6J("ngIf",!i.dataFetch))},directives:[l.Fj,l.JJ,l.On,g.O5,S.A,u.iA,b.jx,u.lQ,u.fz,A.Hq,j.H],styles:[".btn-circle1[_ngcontent-%COMP%]{width:30px;height:30px;padding:0;border-radius:50%;font-size:12px}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:25vh}"]}),o})();var J=r(30567),m=r(45330),Y=r(19114),C=r(49150);function R(o,s){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t.id),e.s9C("label",t.name),e.xp6(1),e.hij(" ",t.name," ")}}function k(o,s){1&o&&(e.TgZ(0,"div",26),e._uU(1,"Year is required."),e.qZA())}function O(o,s){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t.id),e.s9C("label",t.name),e.xp6(1),e.hij(" ",t," ")}}function D(o,s){1&o&&(e.TgZ(0,"div",26),e._uU(1,"Department is required."),e.qZA())}function P(o,s){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t.id),e.s9C("label",t.name),e.xp6(1),e.hij(" ",t," ")}}function E(o,s){1&o&&(e.TgZ(0,"div",26),e._uU(1,"Class is required."),e.qZA())}function Q(o,s){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t.id),e.s9C("label",t.name),e.xp6(1),e.hij(" ",t," ")}}function B(o,s){1&o&&(e.TgZ(0,"div",26),e._uU(1,"Division is required."),e.qZA())}function $(o,s){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t.id),e.s9C("label",t.name),e.xp6(1),e.hij(" ",t," ")}}function V(o,s){1&o&&(e.TgZ(0,"div",26),e._uU(1,"Year is required."),e.qZA())}function H(o,s){1&o&&(e.TgZ(0,"div",27),e._UZ(1,"span",28),e.qZA())}function W(o,s){1&o&&(e.TgZ(0,"tr"),e._UZ(1,"th"),e.TgZ(2,"th"),e._uU(3,"Sl No"),e.qZA(),e.TgZ(4,"th"),e._uU(5,"Subject"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Teacher"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Actions"),e.qZA(),e.qZA())}function z(o,s){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t.id),e.s9C("label",t.name),e.xp6(1),e.hij(" ",t," ")}}function K(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"select",17),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw(3).subjectsToEdit=n}),e.TgZ(2,"option",10),e._uU(3,"Select a Subject"),e.qZA(),e.YNc(4,z,2,3,"option",11),e.qZA(),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.subjectsToEdit),e.xp6(3),e.Q6J("ngForOf",t.subjectList)}}function X(o,s){if(1&o&&e._uU(0),2&o){const t=e.oxw().$implicit;e.hij(" ",t.subject_name," ")}}function G(o,s){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.xp6(1),e.hij(" ",t.employee_name+","," ")}}function ee(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",39),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),a=n.$implicit,c=n.rowIndex;return e.oxw(2).subjectChange(a.subject_allocation_id,c)}),e.qZA(),e.TgZ(2,"button",40),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).editSubjectIndex=-1}),e.qZA(),e.qZA()}}function te(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit;return e.oxw(2).deleteSubject(n)}),e.qZA()}}function ie(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,a=e.oxw(2);return a.editSubjectIndex=n.subject_allocation_id,a.subjectsToEdit=n.subject_id,a.operation="update"}),e.qZA(),e.YNc(1,te,1,0,"button",42)}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!t.teachers.length>0)}}function oe(o,s){if(1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"button",33),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,K,5,2,"div",34),e.YNc(7,X,1,1,"ng-template",null,35,e.W1O),e.qZA(),e.TgZ(9,"td"),e.TgZ(10,"div",36),e.YNc(11,G,2,1,"div",37),e.qZA(),e.qZA(),e.TgZ(12,"td"),e.YNc(13,ee,3,0,"div",34),e.YNc(14,ie,2,1,"ng-template",null,38,e.W1O),e.qZA(),e.qZA()),2&o){const t=s.$implicit,i=s.rowIndex,n=s.expanded,a=e.MAs(8),c=e.MAs(15),d=e.oxw(2);e.xp6(2),e.Q6J("pRowToggler",t)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right"),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Q6J("ngIf",d.editSubjectIndex==t.subject_allocation_id)("ngIfElse",a),e.xp6(5),e.Q6J("ngForOf",t.teachers),e.xp6(2),e.Q6J("ngIf",d.editSubjectIndex==t.subject_allocation_id)("ngIfElse",c)}}function ne(o,s){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Id"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Actions"),e.qZA(),e._UZ(7,"th",49),e.qZA())}function ae(o,s){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.s9C("value",t.employee_id),e.s9C("label",t.employee_name),e.xp6(1),e.hij(" ",t.employee_name," ")}}function se(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"select",52),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw(4).teachersToAsign=n}),e.TgZ(2,"option",10),e._uU(3,"Select a Class"),e.qZA(),e.YNc(4,ae,2,3,"option",11),e.qZA(),e.qZA()}if(2&o){const t=e.oxw(4);e.xp6(1),e.Q6J("ngModel",t.teachersToAsign),e.xp6(3),e.Q6J("ngForOf",t.teacherList)}}function ce(o,s){if(1&o&&e._uU(0),2&o){const t=e.oxw().$implicit;e.hij(" ",t.employee_name," ")}}function re(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",39),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().rowIndex,a=e.oxw(),c=a.$implicit,d=a.rowIndex;return e.oxw(2).teacherChange(c.subject_allocation_id,n,d)}),e.qZA(),e.TgZ(2,"button",40),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().rowIndex,a=e.oxw().rowIndex;return e.oxw(2).canceleChange(a,n)}),e.qZA(),e.qZA()}}function le(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),a=n.rowIndex,c=n.$implicit,d=e.oxw().$implicit,h=e.oxw(2);return h.subjectIndex=d.subject_allocation_id,h.teacherIndex=a,h.operation="update",h.teachersToAsign=c.employee_id,h.teacher_allocation_id=null==c?null:c.teacher_allocation_id}),e.qZA(),e.TgZ(1,"button",54),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit;return e.oxw(3).deleteTeacher(n)}),e.qZA()}}function de(o,s){if(1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.YNc(4,se,5,2,"div",34),e.YNc(5,ce,1,1,"ng-template",null,50,e.W1O),e.qZA(),e.TgZ(7,"td"),e.YNc(8,re,3,0,"div",34),e.YNc(9,le,2,0,"ng-template",null,51,e.W1O),e.qZA(),e.qZA()),2&o){const t=s.rowIndex,i=e.MAs(6),n=e.MAs(10),a=e.oxw().$implicit,c=e.oxw(2);e.xp6(2),e.Oqu(t+1),e.xp6(2),e.Q6J("ngIf",c.subjectIndex==a.subject_allocation_id&&c.teacherIndex==t)("ngIfElse",i),e.xp6(4),e.Q6J("ngIf",c.subjectIndex==a.subject_allocation_id&&c.teacherIndex==t)("ngIfElse",n)}}function pe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td",44),e.TgZ(2,"div",45),e.TgZ(3,"h5"),e._uU(4),e.TgZ(5,"button",46),e.NdJ("click",function(){const n=e.CHM(t),a=n.$implicit,c=n.rowIndex;return e.oxw(2).addTempTeacher(a,c)}),e._uU(6,"Add new"),e.qZA(),e._UZ(7,"div",47),e.qZA(),e.TgZ(8,"p-table",48),e.YNc(9,ne,8,0,"ng-template",30),e.YNc(10,de,11,5,"ng-template",31),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=s.$implicit;e.xp6(4),e.hij(" ","Teacher List for "+t.subject_name," "),e.xp6(4),e.Q6J("value",t.teachers)}}const _e=function(){return[5,10,15]};function ue(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"p-table",29),e.NdJ("selectionChange",function(n){return e.CHM(t),e.oxw().selectedSubjects=n}),e.YNc(1,W,10,0,"ng-template",30),e.YNc(2,oe,16,8,"ng-template",31),e.YNc(3,pe,11,2,"ng-template",32),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("value",t.assignedSubjectList)("selection",t.selectedSubjects)("rows",5)("showCurrentPageReport",!0)("autoLayout",!0)("paginator",!0)("rowsPerPageOptions",e.DdM(7,_e))}}const me=function(){return{width:"40vw"}};let w=(()=>{class o{constructor(t,i,n,a,c){this.confirmationService=t,this.config=i,this.apiService=n,this.toster=a,this.ref=c,this.Loading=!1,this.selectedSubjects=[],this.academinYearList=[],this.departmentList=[],this.classList=[],this.divisionList=[],this.subjectList=[],this.teacherList=[],this.teachersToAsign=[],this.subjectsToAsign="",this.subjectsToEdit="",this.commonForm=new l.cw({subject_allocation_id:new l.NI(""),academic_id:new l.NI("",[l.kI.required]),department_id:new l.NI("",[l.kI.required]),class_id:new l.NI("",[l.kI.required]),division_id:new l.NI("",[l.kI.required]),subject_ids:new l.NI([]),subject_id:new l.NI([])})}ngOnInit(){if(this.teacherList=this.config.data.teacherList,this.subjectList=this.config.data.subjectList,"insert"!=this.config.data.operation){var t=this.config.data.updateDeleteData;for(const i of this.config.data.subjectList)if(i.id==t.subject_id){this.selectedSubjects.push(i);break}this.commonForm.patchValue({subject_allocation_id:t.subject_allocation_id,academic_id:t.academic_id,department_id:t.department_id,class_id:t.class_id,division_id:t.division_id}),this.getSubjects("sdhjf")}}checkForm(t){this.commonForm.valid&&this.getSubjects(t)}getTeacherData(t){this.apiService.getTypeRequest(`specific_data/TEACHER_ALLOCATION/${t.subject_allocation_id}`).toPromise().then(i=>{})}deleteSubject(t){this.confirmationService.confirm({message:"Are you sure that you want to delete?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.Loading=!0,t.teachers.forEach(i=>{this.apiService.postTypeRequest("teacher_allocation_ops/delete",{teacher_allocation_id:i.teacher_allocation_id}).subscribe(a=>{})}),this.apiService.postTypeRequest("subject_allocation_ops/delete",t).subscribe(i=>{i.result?(this.toster.success(i.message),this.getSubjects("baa")):this.toster.error(i.message)}),this.Loading=!1}})}addNewRecord(){this.commonForm.valid&&(this.Loading=!0,this.commonForm.patchValue({subject_ids:[{subject_id:this.subjectsToAsign,teacher_ids:this.teachersToAsign}]}),this.apiService.postTypeRequest("subject_allocation_ops/insert",this.commonForm.value).subscribe(t=>{t.result?(this.toster.success(t.message),this.getSubjects("baa")):this.toster.error(t.message),this.subjectsToAsign=""}),this.teachersToAsign=[],this.subjectsToAsign="",this.Loading=!1)}getSubjects(t){this.commonForm.valid?(this.assignedSubjectList=[],this.Loading=!0,this.apiService.postTypeRequest("subject_allocation_data",this.commonForm.value).toPromise().then(i=>{i.result&&(this.assignedSubjectList=i.data)}).finally(()=>{this.Loading=!1})):this.commonForm.markAllAsTouched()}teacherChange(t,i,n){if("update"==this.operation){var a={teacher_allocation_id:this.teacher_allocation_id,teacher_id:Number(this.teachersToAsign),subject_allocation_id:this.assignedSubjectList[n].subject_allocation_id};this.apiService.postTypeRequest("teacher_allocation_ops/update",a).subscribe(d=>{d.result&&this.getSubjects("")})}else this.apiService.postTypeRequest("teacher_allocation_ops/insert",{subject_allocation_id:t,teacher_ids:[this.teachersToAsign]}).subscribe(d=>{d.result&&(this.subjectIndex=-1,this.teacherIndex=-1,this.getSubjects(""))});this.teachersToAsign=[],this.operation=""}subjectChange(t,i){if("update"==this.operation){var n={subject_allocation_id:t,academic_id:this.commonForm.controls.academic_id.value,department_id:this.commonForm.controls.department_id.value,class_id:this.commonForm.controls.class_id.value,division_id:this.commonForm.controls.division_id.value,subject_id:Number(this.subjectsToEdit),subject_ids:[]};this.apiService.postTypeRequest("subject_allocation_ops/update",n).subscribe(c=>{c.result&&this.getSubjects("")})}else this.apiService.postTypeRequest("subject_allocation_ops/insert",{subject_allocation_id:t,teacher_ids:[this.teachersToAsign]}).subscribe(c=>{c.result&&(this.subjectIndex=-1,this.teacherIndex=-1,this.getSubjects(""))});this.editSubjectIndex=-1,this.subjectsToEdit="",this.operation=""}canceleChange(t,i){var n;this.Loading=!0,(null===(n=this.assignedSubjectList[t].teachers[i])||void 0===n?void 0:n.teacher_allocation_id)||this.assignedSubjectList[t].teachers.splice(i,1),this.subjectIndex=-1,this.teacherIndex=-1,this.Loading=!1}addTempTeacher(t,i){this.Loading=!0,this.assignedSubjectList[i].teachers.push({teacher_allocation_id:"",subject_allocation_id:t.subject_allocation_id,employee_id:"",teacher_id:"",serial_no:"",employee_no:"",employee_name:"",photo:""}),this.Loading=!1,this.operation="insert",this.teacherIndex=this.assignedSubjectList[i].teachers.length-1,this.subjectIndex=t.subject_allocation_id}deleteTeacher(t){this.confirmationService.confirm({message:"Are you sure that you want to delete?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.apiService.postTypeRequest("teacher_allocation_ops/delete",t).subscribe(i=>{i.result&&this.getSubjects("")})}})}submit(){if(this.commonForm.valid&&this.selectedSubjects.length>0){var t=[];for(const i of this.selectedSubjects)t.push(i.id);"insert"==this.config.data.operation?this.commonForm.controls.subject_ids.setValue(t):(this.commonForm.controls.subject_id.setValue(this.config.data.updateDeleteData.subject_id),this.commonForm.controls.subject_ids.setValue([])),this.apiService.postTypeRequest(`subject_allocation_ops/${this.config.data.operation}`,this.commonForm.value).subscribe(i=>{i.result?(this.toster.success(i.message),this.ref.close(!0)):(this.toster.error(i.message),this.ref.close(!1))})}else this.commonForm.valid?this.toster.error("Select atleast 1 subject"):(this.commonForm.markAllAsTouched(),this.toster.error("Fill all required fields"))}cancel(){this.ref.close(!1)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(b.YP),e.Y36(m.S),e.Y36(f.s),e.Y36(_._W),e.Y36(m.E7))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-map-new-subject"]],decls:74,vars:21,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"col-xl-3","col-md-6","col-sm-12","mb-4"],[1,"faq-form"],["for","academic_id"],[1,"font-danger"],["ng-disabled","config.data.operation != 'insert'","id","academic_id","placeholder","2021-2022",1,"form-control",3,"formControl","ngModelChange"],["value",""],[3,"value","label",4,"ngFor","ngForOf"],["class","text text-danger",4,"ngIf"],["for","bg_id"],["id","bg_id","placeholder","2021-2022",1,"form-control",3,"formControl","ngModelChange"],[1,"field","p-fluid"],["for","Subject_id"],["id","Subject_id","placeholder","2021-2022",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-xl-3","col-md-6","col-sm-12","float-right"],[1,"btn","btn-primary","text-center","flex","align-content-end",3,"click"],["class","loader-box center",4,"ngIf"],["dataKey","subject_name","responsiveLayout","scroll",3,"value","selection","rows","showCurrentPageReport","autoLayout","paginator","rowsPerPageOptions","selectionChange",4,"ngIf"],[1,"row","justify-content-around"],[1,"btn","btn-warning",3,"click"],["rejectButtonStyleClass","p-button-text",3,"baseZIndex"],[3,"value","label"],[1,"text","text-danger"],[1,"loader-box","center"],[1,"rotate","dashed"],["dataKey","subject_name","responsiveLayout","scroll",3,"value","selection","rows","showCurrentPageReport","autoLayout","paginator","rowsPerPageOptions","selectionChange"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain","p-button-sm",3,"pRowToggler","icon"],[4,"ngIf","ngIfElse"],["editSubjectName",""],[1,"flex"],[4,"ngFor","ngForOf"],["elseSubjectMenu",""],["pButton","","pRipple","","type","button","icon","pi pi-check","ngbTooltip","Save Teacher",1,"p-button-rounded","btn-danger","ml-1",2,"height","35px","width","35px",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-times","ngbTooltip","Cancel Teacher",1,"p-button-rounded","btn-danger","ml-1",2,"height","35px","width","35px",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","ngbTooltip","Change Subject",1,"p-button-rounded","btn-danger","ml-1",2,"height","35px","width","35px",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-trash","class","p-button-rounded btn-danger ml-1","style","height: 35px; width: 35px","ngbTooltip","Delete Subject",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-trash","ngbTooltip","Delete Subject",1,"p-button-rounded","btn-danger","ml-1",2,"height","35px","width","35px",3,"click"],["colspan","8"],[1,"p-3"],[1,"btn","btn-primary","pull-right",3,"click"],[1,"clearfix"],["dataKey","employee_id",3,"value"],[2,"width","4rem"],["editName",""],["elseMenu",""],["id","bg_id","placeholder","2021-2022",1,"form-control",3,"ngModel","ngModelChange"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","ngbTooltip","Change Teacher",1,"p-button-rounded","btn-danger","ml-1",2,"height","35px","width","35px",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-trash","ngbTooltip","Delete Teacher",1,"p-button-rounded","btn-danger","ml-1",2,"height","35px","width","35px",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",1),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"label",7),e._uU(9,"Academic Year "),e.TgZ(10,"span",8),e._uU(11,"*"),e.qZA(),e.qZA(),e.TgZ(12,"select",9),e.NdJ("ngModelChange",function(a){return i.checkForm(a)}),e.TgZ(13,"option",10),e._uU(14,"Select a academic"),e.qZA(),e.YNc(15,R,2,3,"option",11),e.qZA(),e.YNc(16,k,2,0,"div",12),e.qZA(),e.qZA(),e.TgZ(17,"div",5),e.TgZ(18,"div",6),e.TgZ(19,"label",13),e._uU(20,"Department "),e.TgZ(21,"span",8),e._uU(22,"*"),e.qZA(),e.qZA(),e.TgZ(23,"select",14),e.NdJ("ngModelChange",function(a){return i.checkForm(a)}),e.TgZ(24,"option",10),e._uU(25,"Select a Department"),e.qZA(),e.YNc(26,O,2,3,"option",11),e.qZA(),e.YNc(27,D,2,0,"div",12),e.qZA(),e.qZA(),e.TgZ(28,"div",5),e.TgZ(29,"div",6),e.TgZ(30,"label",13),e._uU(31,"Class"),e.TgZ(32,"span",8),e._uU(33,"*"),e.qZA(),e.qZA(),e.TgZ(34,"select",14),e.NdJ("ngModelChange",function(a){return i.checkForm(a)}),e.TgZ(35,"option",10),e._uU(36,"Select a Class"),e.qZA(),e.YNc(37,P,2,3,"option",11),e.qZA(),e.YNc(38,E,2,0,"div",12),e.qZA(),e.qZA(),e.TgZ(39,"div",5),e.TgZ(40,"div",6),e.TgZ(41,"label",13),e._uU(42,"Division "),e.TgZ(43,"span",8),e._uU(44,"*"),e.qZA(),e.qZA(),e.TgZ(45,"select",14),e.NdJ("ngModelChange",function(a){return i.getSubjects(a)}),e.TgZ(46,"option",10),e._uU(47,"Select a Division"),e.qZA(),e.YNc(48,Q,2,3,"option",11),e.qZA(),e.YNc(49,B,2,0,"div",12),e.qZA(),e.qZA(),e.qZA(),e.TgZ(50,"div",1),e.TgZ(51,"div",5),e.TgZ(52,"div",15),e.TgZ(53,"label",16),e._uU(54,"Subject "),e.TgZ(55,"span",8),e._uU(56,"*"),e.qZA(),e.qZA(),e.TgZ(57,"select",17),e.NdJ("ngModelChange",function(a){return i.subjectsToAsign=a}),e.TgZ(58,"option",10),e._uU(59,"Select a Division"),e.qZA(),e.YNc(60,$,2,3,"option",11),e.qZA(),e.YNc(61,V,2,0,"div",12),e.qZA(),e.qZA(),e.TgZ(62,"div",18),e.TgZ(63,"div",15),e.TgZ(64,"label",13),e._uU(65,"\xa0"),e.qZA(),e.TgZ(66,"button",19),e.NdJ("click",function(){return i.addNewRecord()}),e._uU(67,"Add"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(68,H,2,0,"div",20),e.YNc(69,ue,4,8,"p-table",21),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(70,"div",22),e.TgZ(71,"button",23),e.NdJ("click",function(){return i.cancel()}),e._uU(72,"Cancel"),e.qZA(),e.qZA(),e.qZA(),e._UZ(73,"p-confirmDialog",24)),2&t&&(e.xp6(12),e.Q6J("formControl",i.commonForm.controls.academic_id),e.xp6(3),e.Q6J("ngForOf",i.config.data.academinYearList),e.xp6(1),e.Q6J("ngIf",i.commonForm.controls.academic_id.touched&&(null==i.commonForm.controls.academic_id.errors?null:i.commonForm.controls.academic_id.errors.required)),e.xp6(7),e.Q6J("formControl",i.commonForm.controls.department_id),e.xp6(3),e.Q6J("ngForOf",i.config.data.departmentList),e.xp6(1),e.Q6J("ngIf",i.commonForm.controls.department_id.touched&&(null==i.commonForm.controls.department_id.errors?null:i.commonForm.controls.department_id.errors.required)),e.xp6(7),e.Q6J("formControl",i.commonForm.controls.class_id),e.xp6(3),e.Q6J("ngForOf",i.config.data.classList),e.xp6(1),e.Q6J("ngIf",i.commonForm.controls.class_id.touched&&(null==i.commonForm.controls.class_id.errors?null:i.commonForm.controls.class_id.errors.required)),e.xp6(7),e.Q6J("formControl",i.commonForm.controls.division_id),e.xp6(3),e.Q6J("ngForOf",i.config.data.divisionList),e.xp6(1),e.Q6J("ngIf",i.commonForm.controls.division_id.touched&&(null==i.commonForm.controls.division_id.errors?null:i.commonForm.controls.division_id.errors.required)),e.xp6(8),e.Q6J("ngModel",i.subjectsToAsign),e.xp6(3),e.Q6J("ngForOf",i.subjectList),e.xp6(1),e.Q6J("ngIf",i.commonForm.controls.academic_id.touched&&(null==i.commonForm.controls.academic_id.errors?null:i.commonForm.controls.academic_id.errors.required)),e.xp6(7),e.Q6J("ngIf",i.Loading),e.xp6(1),e.Q6J("ngIf",!i.Loading),e.xp6(4),e.Akn(e.DdM(20,me)),e.Q6J("baseZIndex",1e4))},directives:[l.EJ,l.JJ,l.oH,l.YN,l.Kr,g.sg,g.O5,l.On,Y.Q,u.iA,b.jx,A.Hq,j.H,u.jB,C._L],styles:[".center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]}),o})();var he=r(31424);function ge(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",24),e.TgZ(1,"span",25),e._UZ(2,"i",26),e.TgZ(3,"input",27),e.NdJ("input",function(n){return e.CHM(t),e.oxw(),e.MAs(35).filterGlobal(n.target.value,"contains")}),e.qZA(),e.qZA(),e.qZA()}}function be(o,s){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th",28),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"ID"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Mobile"),e.qZA(),e.qZA())}function fe(o,s){if(1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-tableCheckbox",29),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.qZA()),2&o){const t=s.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.Oqu(t.employee_id),e.xp6(2),e.Oqu(t.employee_name),e.xp6(2),e.Oqu(t.mobile)}}const Ze=function(){return[5,10,15]},Te=function(){return["employee_name","employee_id","representative.name","status"]};let ve=(()=>{class o{constructor(t,i,n,a){this.config=t,this.apiService=i,this.toster=n,this.ref=a,this.isFilter=!0,this.selectedTeachers=[]}ngOnInit(){this.selectedTeachers=this.config.data.selectedTeachers,this.apiService.postTypeRequest("academic_attributes_data",{academic_id:this.config.data.data.academic_id,department_id:this.config.data.data.department_id,class_id:this.config.data.data.class_id,division_id:this.config.data.data.division_id}).toPromise().then(i=>{})}submit(){}cancel(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m.S),e.Y36(f.s),e.Y36(_._W),e.Y36(m.E7))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-map-teachers"]],decls:44,vars:14,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"col-xl-6","col-md-6","col-sm-12","mb-4"],[1,"faq-form"],["for","department"],[1,"font-danger"],["type","text","id","department","placeholder","Report","readonly","",1,"form-control",3,"value"],["for","class_name"],["type","text","id","class_name","placeholder","Report","readonly","",1,"form-control",3,"value"],["for","division_name"],["type","text","id","division_name","placeholder","Report","readonly","",1,"form-control",3,"value"],["for","subject_name"],["type","text","id","subject_name","placeholder","Report","readonly","",1,"form-control",3,"value"],["responsiveLayout","scroll",3,"value","selection","rows","showCurrentPageReport","autoLayout","paginator","rowsPerPageOptions","globalFilterFields","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"row","justify-content-around"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"flex"],[1,"p-input-icon-left","ml-auto","mt-0","mb-0","p-0"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search keyword",3,"input"],[2,"width","3rem"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",1),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"label",7),e._uU(9,"Department "),e.TgZ(10,"span",8),e._uU(11,"*"),e.qZA(),e.qZA(),e._UZ(12,"input",9),e.qZA(),e.qZA(),e.TgZ(13,"div",5),e.TgZ(14,"div",6),e.TgZ(15,"label",10),e._uU(16,"Class"),e.TgZ(17,"span",8),e._uU(18,"*"),e.qZA(),e.qZA(),e._UZ(19,"input",11),e.qZA(),e.qZA(),e.TgZ(20,"div",5),e.TgZ(21,"div",6),e.TgZ(22,"label",12),e._uU(23,"Division "),e.TgZ(24,"span",8),e._uU(25,"*"),e.qZA(),e.qZA(),e._UZ(26,"input",13),e.qZA(),e.qZA(),e.TgZ(27,"div",5),e.TgZ(28,"div",6),e.TgZ(29,"label",14),e._uU(30,"Subject "),e.TgZ(31,"span",8),e._uU(32,"*"),e.qZA(),e.qZA(),e._UZ(33,"input",15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(34,"p-table",16,17),e.NdJ("selectionChange",function(a){return i.selectedTeachers=a}),e.YNc(36,ge,4,0,"ng-template",18),e.YNc(37,be,9,0,"ng-template",19),e.YNc(38,fe,9,4,"ng-template",20),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(39,"div",21),e.TgZ(40,"button",22),e.NdJ("click",function(){return i.submit()}),e._uU(41,"Submit"),e.qZA(),e.TgZ(42,"button",23),e.NdJ("click",function(){return i.cancel()}),e._uU(43,"Cancel"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(12),e.Q6J("value",i.config.data.data.department),e.xp6(7),e.Q6J("value",i.config.data.data.class_name),e.xp6(7),e.Q6J("value",i.config.data.data.division_name),e.xp6(7),e.Q6J("value",i.config.data.data.subject_name),e.xp6(1),e.Q6J("value",i.config.data.teacherList)("selection",i.selectedTeachers)("rows",5)("showCurrentPageReport",!0)("autoLayout",!0)("paginator",!0)("rowsPerPageOptions",e.DdM(12,Ze))("globalFilterFields",e.DdM(13,Te)))},directives:[u.iA,b.jx,he.o,u.Mo,u.UA],styles:[""]}),o})();function Ae(o,s){1&o&&(e.TgZ(0,"div",7),e._UZ(1,"span",8),e.qZA())}function je(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",14),e._uU(1," List of Classes With Allocated Subjects\n"),e.TgZ(2,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addSubjects()}),e._uU(3," +\xa0Add "),e.qZA(),e.qZA()}}function Ce(o,s){1&o&&(e.TgZ(0,"tr"),e.TgZ(1,"th"),e._uU(2,"Slno"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Academin Year"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Department"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Class"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Division"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Actions"),e.qZA(),e.qZA())}function we(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e.TgZ(12,"button",16),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).updateSubject(a)}),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=s.$implicit,i=s.rowIndex;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.academic_name),e.xp6(2),e.Oqu(t.department_name),e.xp6(2),e.Oqu(t.class_name),e.xp6(2),e.Oqu(t.division_name)}}const xe=function(){return[10,25,50]};function qe(o,s){if(1&o&&(e.TgZ(0,"p-table",9,10),e.YNc(2,je,4,0,"ng-template",11),e.YNc(3,Ce,13,0,"ng-template",12),e.YNc(4,we,13,5,"ng-template",13),e.qZA()),2&o){const t=e.oxw();e.Q6J("value",t.mappedSubjects)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(5,xe))}}const Se=[{path:"",pathMatch:"full",redirectTo:"AllSubjects"},{path:"AllSubjects",component:I,data:{title:"Subjects",breadcrumb:"All"}},{path:"MapSubjects",component:(()=>{class o{constructor(t,i,n,a,c){this.confirmationService=t,this.apiService=i,this.spinner=n,this.toster=a,this.dialogService=c,this.dataFetch=!1,this.isFilter=!0,this.academinYearList=[],this.departmentList=[],this.classList=[],this.divisionList=[],this.subjectList=[],this.teacherList=[],this.mappedSubjects=[],this.commonForm=new l.cw({subject_allocation_id:new l.NI(""),academic_id:new l.NI(""),department_id:new l.NI(""),class_id:new l.NI(""),division_id:new l.NI("")})}ngOnInit(){this.getAcademicYears(),this.dataFetch=!0,this.fetchData()}fetchFilterData(){this.dataFetch=!0}getAcademicYears(){this.dataFetch=!0,this.apiService.getTypeRequest("academic_attributes_tree").toPromise().then(t=>{this.data=t.data,this.mappedSubjects=[],this.data.forEach(i=>{i.department_data.length>0&&this.academinYearList.push({academic_year_id:i.academic_year_id,academic_year_name:i.academic_year_name}),i.department_data.forEach(a=>{a.class_data.forEach(c=>{c.division_data.forEach(d=>{this.mappedSubjects.push({academic_id:i.academic_year_id,academic_name:i.academic_year_name,department_id:a.department_id,department_name:a.department_name,class_id:c.class_id,class_name:c.class_name,division_id:d.division_id,division_name:d.division_name})})})})}),this.dataFetch=!1})}getDepartments(t){for(const i of this.data)if(i.academic_year_id==this.commonForm.controls.academic_id.value){this.departmentList=[],i.department_data.forEach(n=>{this.departmentList.push(n)});break}}getClasses(t){for(const i of this.departmentList)if(i.department_id==this.commonForm.controls.department_id.value){this.classList=[],i.class_data.forEach(n=>{this.classList.push(n)});break}}getDivisions(t){for(const i of this.classList)if(i.class_id==this.commonForm.controls.class_id.value){this.divisionList=[],i.division_data.forEach(n=>{this.divisionList.push(n)});break}}getSubjects(t){this.apiService.postTypeRequest("academic_attributes_data",this.commonForm.value).toPromise().then(i=>{})}fetchData(){var t,i,n,a,c;this.commonForm.patchValue({subject_allocation_id:null!==(t=this.commonForm.controls.subject_allocation_id.value)&&void 0!==t?t:null,academic_id:null!==(i=this.commonForm.controls.academic_id.value)&&void 0!==i?i:null,department_id:null!==(n=this.commonForm.controls.department_id.value)&&void 0!==n?n:null,class_id:null!==(a=this.commonForm.controls.class_id.value)&&void 0!==a?a:null,division_id:null!==(c=this.commonForm.controls.division_id.value)&&void 0!==c?c:null}),(0,J.D)([this.dataFetch=!0,this.apiService.getTypeRequest("table_data/SUBJECT").toPromise().then(d=>{this.subjectList=d.data}),this.apiService.getTypeRequest("new_table_data/ALL_EMPLOYEES").toPromise().then(d=>{this.teacherList=d.data}),this.apiService.getTypeRequest("admission_form_data").toPromise().then(d=>{this.admission_form_data=d.data})])}clearData(){this.commonForm.reset({subject_allocation_id:"",academic_id:"",department_id:"",class_id:"",division_id:""}),this.fetchData()}addSubjects(){this.dialogService.open(w,{data:{operation:"insert",academinYearList:this.admission_form_data.academic_year,departmentList:this.admission_form_data.department,classList:this.admission_form_data.class,divisionList:this.admission_form_data.division,subjectList:this.subjectList,teacherList:this.teacherList},header:"Subject Class Mapping",styleClass:"w-11 sm:w-10 md:w-11 lg:w-8"}).onClose.subscribe(i=>{i&&this.fetchData()})}updateSubject(t){this.dialogService.open(w,{data:{operation:"update",updateDeleteData:t,academinYearList:this.admission_form_data.academic_year,departmentList:this.admission_form_data.department,classList:this.admission_form_data.class,divisionList:this.admission_form_data.division,subjectList:this.subjectList,teacherList:this.teacherList},header:"Update Mapped Subjects",styleClass:"w-11 sm:w-10 md:w-11 lg:w-8"}).onClose.subscribe(n=>{n&&this.fetchData()})}deleteSubject(t){}updateTeacher(t){var i=[];this.apiService.getTypeRequest(`specific_data/TEACHER_ALLOCATION/${t.subject_allocation_id}`).toPromise().then(n=>{if(n.result)for(const c of this.teacherList)if(c.employee_id==n.data.teacher_id){i.push(c);break}this.dialogService.open(ve,{data:{data:t,teacherList:this.teacherList,selectedTeachers:i},header:"Subject Teacher Mapping",styleClass:"w-10 sm:w-10 md:w-10 lg:w-6"}).onClose.subscribe(c=>{c&&this.fetchData()})})}submit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(b.YP),e.Y36(f.s),e.Y36(p.V),e.Y36(_._W),e.Y36(m.xA))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-map-subjects"]],decls:7,vars:2,consts:[[1,"container-fluid"],[1,"row"],[1,"col"],[1,"card"],[1,"card-body"],["class","loader-box center",4,"ngIf"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions",4,"ngIf"],[1,"loader-box","center"],[1,"rotate","dashed"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex","justify-content-between"],["type","button",1,"btn","btn-primary",2,"max-height","36px",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-cog","ngbTooltip","Update Subject",1,"p-button-rounded","btn-primary","ml-1",2,"height","35px","width","35px",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.YNc(5,Ae,2,0,"div",5),e.YNc(6,qe,5,6,"p-table",6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngIf",i.dataFetch),e.xp6(1),e.Q6J("ngIf",!i.dataFetch))},directives:[g.O5,u.iA,b.jx,A.Hq,j.H,C._L],styles:[".center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]}),o})(),data:{title:"Subjects",breadcrumb:"Map"}}];let Me=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[T.Bz.forChild(Se)],T.Bz]}),o})();var ye=r(79189),Ne=r(51361),Ue=r(15091);let Fe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[m.E7,m.S,m.xA,b.YP,u.D$],imports:[[g.ez,Me,ye.O,Ne.m,Ue.yI.forRoot()]]}),o})()},4426:(x,Z,r)=>{r.d(Z,{Y:()=>v});var g=r(5e3);const T=r(35226);let v=(()=>{class e{constructor(){this.swalWithBootstrapButtons=T.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1})}showSuccessMessage(p,_){this.swalWithBootstrapButtons.fire(p,_,"success")}showErrorMessage(p,_){this.swalWithBootstrapButtons.fire(p,_,"error")}showWarningMessage(p,_){this.swalWithBootstrapButtons.fire(p,_,"warning")}showConfirmDialog(){return this.swalWithBootstrapButtons.fire({title:"Are you sure, you want to delete?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",reverseButtons:!0})}showDeleteConfirmDialog(){return this.swalWithBootstrapButtons.fire({title:"Are you sure, you want to delete?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",reverseButtons:!0})}showUpdateConfirmDialog(){return this.swalWithBootstrapButtons.fire({title:"Are you sure, you want to update?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, update it!",cancelButtonText:"No, cancel!",reverseButtons:!0})}}return e.\u0275fac=function(p){return new(p||e)},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);